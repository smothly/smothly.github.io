<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>다양한 데이터 소스 통합 | SeungHo Choi</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/favicon-256x256.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Prism.js for code highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        
        /* 마크다운 스타일링 */
        .prose {
            max-width: none;
            color: #374151;
            line-height: 1.75;
        }
        
        .prose h1 {
            font-size: 2.5rem;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 2rem;
            margin-top: 3rem;
            padding-bottom: 0.75rem;
            border-bottom: 3px solid #3b82f6;
        }
        
        .prose h2 {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 1.5rem;
            margin-top: 2.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e5e7eb;
            position: relative;
        }
        
        .prose h2::before {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 60px;
            height: 2px;
            background: #3b82f6;
        }
        
        .prose h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 1rem;
            margin-top: 2rem;
        }
        
        .prose h4 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #4b5563;
            margin-bottom: 0.75rem;
            margin-top: 1.5rem;
        }
        
        .prose p {
            margin-bottom: 1.5rem;
            color: #4b5563;
            line-height: 1.8;
        }
        
        .prose ul, .prose ol {
            margin-bottom: 1.5rem;
            padding-left: 1.5rem;
        }
        
        .prose li {
            margin-bottom: 0.5rem;
            color: #4b5563;
            line-height: 1.7;
        }
        
        .prose ul li {
            position: relative;
            list-style: none;
        }
        
        .prose ul li::before {
            content: '•';
            color: #3b82f6;
            font-weight: bold;
            position: absolute;
            left: -1rem;
        }
        
        .prose ol li {
            list-style: decimal;
            color: #4b5563;
        }
        
        .prose strong {
            font-weight: 600;
            color: #1f2937;
        }
        
        .prose em {
            font-style: italic;
            color: #6b7280;
        }
        
        .prose blockquote {
            border-left: 4px solid #3b82f6;
            padding-left: 1.5rem;
            margin: 2rem 0;
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 0.5rem;
            font-style: italic;
            color: #4b5563;
        }
        
        .prose code {
            background: #f1f5f9;
            color: #e11d48;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            border: 1px solid #e2e8f0;
        }
        
        .prose pre {
            background: #1e293b !important;
            color: #e2e8f0 !important;
            padding: 1.5rem !important;
            border-radius: 0.75rem !important;
            overflow-x: auto !important;
            margin: 2rem 0 !important;
            border: 1px solid #334155 !important;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1) !important;
        }
        
        .prose pre code {
            background: transparent !important;
            color: inherit !important;
            padding: 0 !important;
            border: none !important;
            border-radius: 0 !important;
            font-size: 0.875rem !important;
        }
        
        .prose img {
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            margin: 2rem 0;
            max-width: 100%;
            height: auto;
            cursor: zoom-in;
            transition: transform 0.3s ease;
        }

        .prose img:hover {
            transform: scale(1.02);
        }
        
        .prose table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            background: white;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .prose th {
            background: #f8fafc;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .prose td {
            padding: 1rem;
            border-bottom: 1px solid #f3f4f6;
            color: #4b5563;
        }
        
        .prose hr {
            border: none;
            height: 2px;
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            margin: 3rem 0;
            border-radius: 1px;
        }
        
        /* 특별한 강조 박스 */
        .prose p:has(strong:first-child) {
            background: linear-gradient(135deg, #eff6ff 0%, #f0f9ff 100%);
            border-left: 4px solid #3b82f6;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
        }
    </style>
</head>
<body class="bg-gray-50">
    
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <a href="/" class="text-xl font-bold text-gray-800 hover:text-blue-600 transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i> SeungHo Choi
                </a>
                <div class="flex space-x-4">
                    <!-- GitHub 링크 제거됨 -->
                </div>
            </div>
        </div>
    </nav>

    <!-- Project Header -->
    <section class="gradient-bg text-white py-20">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-4xl md:text-5xl font-bold mb-6 leading-tight">다양한 데이터 소스 통합</h1>
                <p class="text-xl text-white/90 mb-8 leading-relaxed">ElasticSearch, Google/Apple 마켓, Prometheus, Redis, SensorTower 등 15개 이상의 다양한 외부 데이터 소스를 안정적으로 수집하는 ETL 구축</p>
                <div class="flex justify-center items-center space-x-8 text-white/80">
                    <span class="flex items-center">
                        <i class="fas fa-calendar mr-2"></i>2021.01 - 
                    </span>
                </div>
            </div>
        </div>
    </section>

    <!-- Project Content -->
    <section class="py-20">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            
            <!-- Tech Stack -->
            <div class="bg-white rounded-2xl p-8 shadow-lg mb-8 border border-gray-100">
                <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                    <i class="fas fa-tools mr-3 text-blue-600"></i>
                    기술 스택
                </h2>
                <div class="flex flex-wrap gap-3">
                    
                    <span class="px-4 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 rounded-full font-medium border border-blue-200 hover:shadow-md transition-shadow">
                        Prefect
                    </span>
                    
                    <span class="px-4 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 rounded-full font-medium border border-blue-200 hover:shadow-md transition-shadow">
                        ElasticSearch
                    </span>
                    
                    <span class="px-4 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 rounded-full font-medium border border-blue-200 hover:shadow-md transition-shadow">
                        Redis
                    </span>
                    
                    <span class="px-4 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 rounded-full font-medium border border-blue-200 hover:shadow-md transition-shadow">
                        Prometheus
                    </span>
                    
                    <span class="px-4 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 rounded-full font-medium border border-blue-200 hover:shadow-md transition-shadow">
                        RDS Snapshot
                    </span>
                    
                    <span class="px-4 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 rounded-full font-medium border border-blue-200 hover:shadow-md transition-shadow">
                        API Integration
                    </span>
                    
                </div>
            </div>

            <!-- Project Details -->
            <div class="bg-white rounded-2xl p-8 shadow-lg border border-gray-100">
                <div class="prose prose-lg max-w-none">
                    <h2>개요</h2>
<p>단일 데이터 소스로는 얻을 수 없는 깊이 있는 비즈니스 인사이트를 확보하기 위해, <strong>15개 이상의 내/외부 이종 데이터 소스를 통합 수집하는 파이프라인들을 구축</strong>했습니다. 각 데이터 소스의 고유한 API 제약, 데이터 구조, 수집 주기를 고려한 맞춤형 수집 전략을 통해, 파편화된 데이터를 연결하여 비즈니스의 전체 그림을 볼 수 있는 기반을 마련했습니다.</p>
<hr />
<h2>주요 데이터 소스 및 수집 전략</h2>
<p>데이터 엔지니어로서 각 소스의 기술적 특성과 비즈니스적 중요도를 파악하고, 안정성과 효율성을 모두 고려한 맞춤형 수집 파이프라인을 설계했습니다.</p>
<h3>1. ElasticSearch</h3>
<p><img alt="ElasticSearch" src="/static/images/projects/diverse-data-sources/elastic_search.png" /></p>
<ul>
<li><strong>목적</strong>: 게임 클라이언트 및 서버에서 발생하는 대용량 비정형 로그를 분석용 데이터로 변환.</li>
<li><strong>도전 과제</strong>: 실시간으로 쌓이는 대용량 로그를 프로덕션 클러스터에 영향을 주지 않고 효율적으로 추출해야 했습니다. 또한, 중첩된 JSON 구조의 로그를 분석하기 쉬운 정형 데이터로 변환하는 과정이 필요했습니다.</li>
<li><strong>해결 방안</strong>:<ul>
<li><strong>Scroll API 활용</strong>: 대용량 데이터 추출 시 메모리 부하를 최소화하기 위해 <code>Scroll API</code>를 사용하여 페이지네이션 방식으로 데이터를 안정적으로 가져왔습니다.</li>
</ul>
</li>
</ul>
<h3>2. Google Play &amp; Apple App Store</h3>
<ul>
<li><strong>목적</strong>: 앱 리뷰, 평점, 다운로드 수 등 경쟁 분석 및 사용자 피드백 파악에 필수적인 마켓 데이터 수집.</li>
<li><strong>도전 과제</strong>: 각 마켓 콘솔에서 제공하는 <strong>보고서 내용을 다운받아서 DW에 활용 가능한 형태로 변환</strong>해야 했습니다. 또한 <strong>여러 계정에서 데이터를 수집해야 하므로 계정 연동에 어려움</strong>이 있었습니다.</li>
<li><strong>해결 방안</strong>:<ul>
<li><strong>데이터 수집 자동화</strong>: google play 같은 경우는 여러 계정에서 <a href="https://cloud.google.com/bigquery/docs/play-transfer?hl=ko">bigquery transfer</a>를 활용하여 적재하고, apple app store는 <a href="https://developer.apple.com/documentation/appstoreconnectapi">app store connect api</a> 통해 데이터를 수집했습니다.</li>
<li><strong>데이터 모델 표준화</strong>: 각 계정을 공통계정으로 연동하는 가이드를 마련하여 5개가 넘는 계정에서의 보고서 데이터를 수집하였으며, Google과 Apple에서 수집된 데이터를 <code>앱이름</code>, <code>평점</code>, <code>리뷰수</code> 등 공통된 필드를 가진 표준 스키마로 정규화하여 저장함으로써, 플랫폼에 구애받지 않는 통합 분석을 가능하게 했습니다.</li>
</ul>
</li>
</ul>
<h3>3. Influx/Prometheus</h3>
<ul>
<li><strong>목적</strong>: 서버, 데이터베이스 등 핵심 인프라의 CPU, 메모리, 네트워크 등 시계열(Time-series) 메트릭을 수집하여 시스템 상태 모니터링 및 이상 탐지에 활용.</li>
<li><strong>도전 과제</strong>: 초 단위로 발생하는 방대한 양의 메트릭 데이터를 효율적으로 저장하고, 분석에 의미 있는 정보로 가공해야 했습니다.</li>
<li><strong>해결 방안</strong>: Prometheus의 <code>HTTP API</code>와 <code>PromQL</code>을 사용하여 필요한 메트릭만 집계(Aggregation)된 형태로 조회했습니다. 원본(Raw) 데이터가 아닌 1분, 5분 단위로 집계된 데이터를 수집하여 저장 데이터의 양을 최적화하고 분석 성능을 높였습니다.</li>
</ul>
<h3>4. Redis</h3>
<ul>
<li><strong>목적</strong>: 실시간 랭킹, 사용자 세션 등 휘발성 데이터를 분석용으로 스냅샷을 생성하고 저장.</li>
<li><strong>도전 과제</strong>: In-memory 데이터베이스인 Redis의 특성상, 대량의 데이터를 조회하는 작업은 프로덕션 서비스에 직접적인 성능 부하를 줄 수 있었습니다.</li>
<li><strong>해결 방안</strong>: <code>KEYS</code> 명령어 대신, Blocking 없이 점진적으로 키를 스캔하는 <code>SCAN</code> 명령어를 사용했습니다. 또한, 프로덕션에 영향을 주지 않기 위해 <strong>Read Replica(복제본) 노드에서 데이터 추출 작업을 수행</strong>하여 서비스 안정성을 확보했습니다.</li>
</ul>
<h3>5. GeoIP &amp; Proxy 데이터</h3>
<ul>
<li><strong>목적</strong>: 사용자 접속 IP를 기반으로 국가, 도시 등 위치 정보를 파악하고, Proxy/VPN 사용 여부를 판별하여 부정 사용자를 필터링.</li>
<li><strong>도전 과제</strong>: MaxMind와 같은 외부 GeoIP 데이터베이스는 주기적으로 업데이트되므로, 항상 최신 버전을 유지해야 했습니다.</li>
<li><strong>해결 방안</strong>: 최신 DB 파일이 릴리즈되면 이를 자동으로 감지하여 <strong>S3에 다운로드하고, 이를 기반으로 데이터 웨어하우스의 IP 조회용 Lookup 테이블을 자동으로 업데이트</strong>하는 파이프라인을 구축했습니다.</li>
</ul>
<h3>6. SensorTower API</h3>
<p><img alt="sensortower_api" src="/static/images/projects/diverse-data-sources/sensortower_api.png" /></p>
<ul>
<li><strong>목적</strong>: 경쟁사 앱의 다운로드, 매출 추정치 등 외부 시장 정보를 수집하여 경쟁 전략 수립에 활용.</li>
<li><strong>도전 과제</strong>: 호출 당 비용이 발생하는 유료 API이므로, 불필요한 호출을 최소화하고 비용을 최적화해야 했습니다.</li>
<li><strong>해결 방안</strong>: API 호출 결과를 <strong>S3에 캐싱(Caching)</strong>하여 동일한 조건의 요청은 실제 API를 호출하지 않고 캐시된 데이터를 사용하도록 설계했습니다. 또한, 데이터의 중요도에 따라 수집 주기를 차등(예: 핵심 경쟁사는 매일, 기타는 주간) 적용하여 비용 효율을 높였습니다.</li>
</ul>
<h3>7. 환율 데이터</h3>
<p><img alt="exchange_rate" src="/static/images/projects/diverse-data-sources/exchange_rate.png" /></p>
<ul>
<li><strong>목적</strong>: 글로벌 서비스의 해외 통화 매출을 기준 통화(USD)로 환산하여 정확한 전체 매출을 집계.</li>
<li><strong>도전 과제</strong>: 매일 변동되는 환율 정보를 안정적으로 수집해야 하며, 특정일의 환율 정보가 누락될 경우 매출 집계에 오류가 발생할 수 있었습니다.</li>
<li><strong>해결 방안</strong>: 신뢰도 높은 금융 정보 API를 통해 매일 환율 정보를 수집하고, <strong>API 장애 시 대체 소스에서 정보를 가져오는 이중화 구조</strong>를 설계했습니다. 수집된 환율은 날짜별로 DW에 저장하여 과거 특정 시점의 매출도 정확하게 재계산할 수 있도록 했습니다.</li>
</ul>
<h3>8. RDS Snapshot</h3>
<p><img alt="rds_snapshot" src="/static/images/projects/diverse-data-sources/rds_snapshot.png" /></p>
<ul>
<li><strong>목적</strong>: 프로덕션 데이터베이스의 부하 없이 대규모 데이터를 데이터 웨어하우스로 이전.</li>
<li><strong>도전 과제</strong>: 운영 중인 DB에 직접 대량의 SELECT 쿼리를 실행하는 것은 서비스 장애를 유발할 수 있습니다.</li>
<li><strong>해결 방안</strong>: 매일 새벽에 생성되는 <strong>RDS 스냅샷을 S3로 Export</strong>한 뒤, S3에서 안전하게 데이터를 추출(ETL)했습니다. 스냅샷은 보관기간을 두어 데이터 저장 비용의 낭비도 막았습니다.</li>
</ul>
<h3>9. Google Play Voided Purchases API</h3>
<ul>
<li><strong>목적</strong>: 사용자의 구매 취소(환불) 내역을 정확하게 반영하여 신뢰도 있는 매출 지표를 산출.</li>
<li><strong>도전 과제</strong>: 환불 데이터는 일반 결제 데이터와 별도의 API를 통해 제공되므로, 두 데이터를 정확하게 동기화해야 했습니다.</li>
<li><strong>해결 방안</strong>: 주기적으로 <strong>Voided Purchases API를 호출하여 환불된 거래 목록을 가져오고, 이를 데이터 웨어하우스의 원본 결제 데이터에 반영</strong>하여 환불된 거래를 명확히 식별(Flagging)하는 배치 파이프라인을 구축했습니다.</li>
</ul>
                </div>
            </div>

            <!-- Back to Projects -->
            <div class="text-center mt-12">
                <a href="/#projects" class="inline-flex items-center px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-full hover:from-blue-700 hover:to-indigo-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1">
                    <i class="fas fa-arrow-left mr-3"></i>
                    프로젝트 목록으로 돌아가기
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p class="text-gray-300">&copy; 2025 SeungHo Choi. All rights reserved.</p>
        </div>
    </footer>

    <!-- Lightbox Modal -->
    <div id="lightbox" class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-[100] hidden p-4">
        <img id="lightbox-img" src="" alt="Enlarged image" class="max-w-full max-h-full object-contain rounded-lg">
        <button id="lightbox-close" class="absolute top-6 right-6 text-white text-4xl font-bold">&times;</button>
    </div>

    <!-- Prism.js for code highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = document.getElementById('lightbox-img');
            const lightboxClose = document.getElementById('lightbox-close');

            document.querySelectorAll('.prose img').forEach(img => {
                img.addEventListener('click', () => {
                    lightbox.classList.remove('hidden');
                    lightboxImg.src = img.src;
                });
            });

            const closeLightbox = () => {
                lightbox.classList.add('hidden');
                lightboxImg.src = '';
            };

            lightbox.addEventListener('click', (e) => {
                if (e.target === lightbox) {
                    closeLightbox();
                }
            });

            lightboxClose.addEventListener('click', closeLightbox);

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !lightbox.classList.contains('hidden')) {
                    closeLightbox();
                }
            });
        });
    </script>
</body>
</html>