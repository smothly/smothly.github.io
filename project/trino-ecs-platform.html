<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trino on ECS 기반 DataLake 플랫폼 | SeungHo Choi</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/favicon-256x256.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Prism.js for code highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        
        /* 마크다운 스타일링 */
        .prose {
            max-width: none;
            color: #374151;
            line-height: 1.75;
        }
        
        .prose h1 {
            font-size: 2.5rem;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 2rem;
            margin-top: 3rem;
            padding-bottom: 0.75rem;
            border-bottom: 3px solid #3b82f6;
        }
        
        .prose h2 {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 1.5rem;
            margin-top: 2.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e5e7eb;
            position: relative;
        }
        
        .prose h2::before {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 60px;
            height: 2px;
            background: #3b82f6;
        }
        
        .prose h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 1rem;
            margin-top: 2rem;
        }
        
        .prose h4 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #4b5563;
            margin-bottom: 0.75rem;
            margin-top: 1.5rem;
        }
        
        .prose p {
            margin-bottom: 1.5rem;
            color: #4b5563;
            line-height: 1.8;
        }
        
        .prose ul, .prose ol {
            margin-bottom: 1.5rem;
            padding-left: 1.5rem;
        }
        
        .prose li {
            margin-bottom: 0.5rem;
            color: #4b5563;
            line-height: 1.7;
        }
        
        .prose ul li {
            position: relative;
            list-style: none;
        }
        
        .prose ul li::before {
            content: '•';
            color: #3b82f6;
            font-weight: bold;
            position: absolute;
            left: -1rem;
        }
        
        .prose ol li {
            list-style: decimal;
            color: #4b5563;
        }
        
        .prose strong {
            font-weight: 600;
            color: #1f2937;
        }
        
        .prose em {
            font-style: italic;
            color: #6b7280;
        }
        
        .prose blockquote {
            border-left: 4px solid #3b82f6;
            padding-left: 1.5rem;
            margin: 2rem 0;
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 0.5rem;
            font-style: italic;
            color: #4b5563;
        }
        
        .prose code {
            background: #f1f5f9;
            color: #e11d48;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            border: 1px solid #e2e8f0;
        }
        
        .prose pre {
            background: #1e293b !important;
            color: #e2e8f0 !important;
            padding: 1.5rem !important;
            border-radius: 0.75rem !important;
            overflow-x: auto !important;
            margin: 2rem 0 !important;
            border: 1px solid #334155 !important;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1) !important;
        }
        
        .prose pre code {
            background: transparent !important;
            color: inherit !important;
            padding: 0 !important;
            border: none !important;
            border-radius: 0 !important;
            font-size: 0.875rem !important;
        }
        
        .prose img {
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            margin: 2rem 0;
            max-width: 100%;
            height: auto;
        }
        
        .prose table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            background: white;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .prose th {
            background: #f8fafc;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .prose td {
            padding: 1rem;
            border-bottom: 1px solid #f3f4f6;
            color: #4b5563;
        }
        
        .prose hr {
            border: none;
            height: 2px;
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            margin: 3rem 0;
            border-radius: 1px;
        }
        
        /* 특별한 강조 박스 */
        .prose p:has(strong:first-child) {
            background: linear-gradient(135deg, #eff6ff 0%, #f0f9ff 100%);
            border-left: 4px solid #3b82f6;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
        }
    </style>
</head>
<body class="bg-gray-50">
    
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <a href="/" class="text-xl font-bold text-gray-800 hover:text-blue-600 transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i> SeungHo Choi
                </a>
                <div class="flex space-x-4">
                    <!-- GitHub 링크 제거됨 -->
                </div>
            </div>
        </div>
    </nav>

    <!-- Project Header -->
    <section class="gradient-bg text-white py-20">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-4xl md:text-5xl font-bold mb-6 leading-tight">Trino on ECS 기반 DataLake 플랫폼</h1>
                <p class="text-xl text-white/90 mb-8 leading-relaxed">Trino를 AWS ECS에 배포하여 다양한 데이터 소스를 통합 쿼리할 수 있는 DataLake 환경 구축. Apache Iceberg 테이블 포맷을 활용한 원본 데이터 확인 및 Ad-hoc 쿼리 플랫폼 제공</p>
                <div class="flex justify-center items-center space-x-8 text-white/80">
                    <span class="flex items-center">
                        <i class="fas fa-calendar mr-2"></i>2023.12 - 2024.01
                    </span>
                </div>
            </div>
        </div>
    </section>

    <!-- Project Content -->
    <section class="py-20">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            
            <!-- Tech Stack -->
            <div class="bg-white rounded-2xl p-8 shadow-lg mb-8 border border-gray-100">
                <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                    <i class="fas fa-tools mr-3 text-blue-600"></i>
                    기술 스택
                </h2>
                <div class="flex flex-wrap gap-3">
                    
                    <span class="px-4 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 rounded-full font-medium border border-blue-200 hover:shadow-md transition-shadow">
                        Trino
                    </span>
                    
                    <span class="px-4 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 rounded-full font-medium border border-blue-200 hover:shadow-md transition-shadow">
                        AWS ECS
                    </span>
                    
                    <span class="px-4 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 rounded-full font-medium border border-blue-200 hover:shadow-md transition-shadow">
                        Apache Iceberg
                    </span>
                    
                    <span class="px-4 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 rounded-full font-medium border border-blue-200 hover:shadow-md transition-shadow">
                        S3 Lifecycle
                    </span>
                    
                    <span class="px-4 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 rounded-full font-medium border border-blue-200 hover:shadow-md transition-shadow">
                        Glue Catalog
                    </span>
                    
                    <span class="px-4 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 rounded-full font-medium border border-blue-200 hover:shadow-md transition-shadow">
                        Terraform
                    </span>
                    
                </div>
            </div>

            <!-- Project Details -->
            <div class="bg-white rounded-2xl p-8 shadow-lg border border-gray-100">
                <div class="prose prose-lg max-w-none">
                    <h1>Trino on ECS 기반 DataLake 플랫폼</h1>
<h2>프로젝트 개요</h2>
<p>다양한 데이터 소스에 분산되어 있는 데이터를 통합적으로 조회하고 분석하기 위해 Trino(구 PrestoSQL)를 AWS ECS에 배포한 DataLake 플랫폼을 구축했습니다. Apache Iceberg 테이블 포맷을 활용하여 원본 데이터 확인과 Ad-hoc 쿼리를 효율적으로 지원하는 시스템을 개발했습니다.</p>
<p><strong>핵심 성과:</strong>
- ECS 기반 Auto Scaling으로 탄력적 자원 관리
- Apache Iceberg 테이블 포맷으로 스키마 진화 지원
- 15개 이상 데이터 소스 통합 쿼리 지원
- S3 Lifecycle 정책으로 비용 최적화</p>
<h2>프로젝트 목표</h2>
<h3>비즈니스 요구사항</h3>
<ol>
<li><strong>통합 데이터 접근</strong>: 분산된 데이터 소스를 단일 SQL 인터페이스로 통합</li>
<li><strong>Ad-hoc 분석 지원</strong>: 데이터 분석가의 자유로운 탐색적 분석 지원</li>
<li><strong>원본 데이터 검증</strong>: ETL 과정에서 발생하는 데이터 변화 추적 및 검증</li>
<li><strong>비용 효율성</strong>: 필요 시에만 리소스를 사용하는 탄력적 플랫폼</li>
</ol>
<h3>기술적 목표</h3>
<ul>
<li>Federated Query를 통한 다양한 데이터 소스 통합</li>
<li>Iceberg 테이블 포맷을 활용한 ACID 트랜잭션 지원</li>
<li>ECS 기반 컨테이너 오케스트레이션으로 고가용성 확보</li>
<li>S3 Lifecycle 정책을 통한 자동 비용 최적화</li>
</ul>
<h2>기술적 도전과 해결 과정</h2>
<h3>1. 아키텍처 설계</h3>
<p><strong>도전 과제:</strong>
- 다양한 데이터 소스 간 성능 차이
- 대용량 데이터 처리 시 메모리 관리
- 동적 스케일링과 고가용성 보장</p>
<p><strong>해결 방안:</strong></p>
<pre class="codehilite"><code>ECS Cluster Architecture
├── Trino Coordinator (ECS Service)
│   ├── Auto Scaling Group (1-3 tasks)
│   ├── Application Load Balancer
│   └── Service Discovery
├── Trino Workers (ECS Service)
│   ├── Auto Scaling Group (2-10 tasks)
│   ├── Memory-optimized instances (r5.xlarge)
│   └── Spot Instance 활용
└── Data Sources Integration
    ├── S3 (Iceberg Tables)
    ├── Redshift Connector
    ├── BigQuery Connector
    ├── MySQL Connector
    └── ElasticSearch Connector
</code></pre>

<h3>2. ECS 기반 Trino 클러스터 구축</h3>
<p><strong>ECS Task Definition 최적화:</strong></p>
<pre class="codehilite"><code class="language-json">{
  &quot;family&quot;: &quot;trino-coordinator&quot;,
  &quot;networkMode&quot;: &quot;awsvpc&quot;,
  &quot;requiresCompatibilities&quot;: [&quot;EC2&quot;],
  &quot;cpu&quot;: &quot;2048&quot;,
  &quot;memory&quot;: &quot;8192&quot;,
  &quot;taskRoleArn&quot;: &quot;arn:aws:iam::account:role/TrinoTaskRole&quot;,
  &quot;containerDefinitions&quot;: [
    {
      &quot;name&quot;: &quot;trino-coordinator&quot;,
      &quot;image&quot;: &quot;trinodb/trino:latest&quot;,
      &quot;essential&quot;: true,
      &quot;portMappings&quot;: [
        {
          &quot;containerPort&quot;: 8080,
          &quot;protocol&quot;: &quot;tcp&quot;
        }
      ],
      &quot;environment&quot;: [
        {
          &quot;name&quot;: &quot;TRINO_ENVIRONMENT&quot;,
          &quot;value&quot;: &quot;production&quot;
        }
      ],
      &quot;mountPoints&quot;: [
        {
          &quot;sourceVolume&quot;: &quot;trino-config&quot;,
          &quot;containerPath&quot;: &quot;/etc/trino&quot;
        }
      ],
      &quot;logConfiguration&quot;: {
        &quot;logDriver&quot;: &quot;awslogs&quot;,
        &quot;options&quot;: {
          &quot;awslogs-group&quot;: &quot;/ecs/trino-coordinator&quot;,
          &quot;awslogs-region&quot;: &quot;ap-northeast-2&quot;,
          &quot;awslogs-stream-prefix&quot;: &quot;ecs&quot;
        }
      }
    }
  ],
  &quot;volumes&quot;: [
    {
      &quot;name&quot;: &quot;trino-config&quot;,
      &quot;efsVolumeConfiguration&quot;: {
        &quot;fileSystemId&quot;: &quot;fs-xxxxxxxxx&quot;,
        &quot;transitEncryption&quot;: &quot;ENABLED&quot;
      }
    }
  ]
}
</code></pre>

<p><strong>Auto Scaling 정책 구현:</strong></p>
<pre class="codehilite"><code class="language-python">import boto3

def setup_trino_autoscaling():
    &quot;&quot;&quot;Trino 워커 노드의 오토스케일링 설정&quot;&quot;&quot;

    client = boto3.client('application-autoscaling')

    # 스케일링 타겟 등록
    client.register_scalable_target(
        ServiceNamespace='ecs',
        ResourceId='service/trino-cluster/trino-worker',
        ScalableDimension='ecs:service:DesiredCount',
        MinCapacity=2,
        MaxCapacity=10,
        RoleARN='arn:aws:iam::account:role/ECSAutoScalingRole'
    )

    # CPU 기반 스케일링 정책
    client.put_scaling_policy(
        PolicyName='trino-worker-cpu-scaling',
        ServiceNamespace='ecs',
        ResourceId='service/trino-cluster/trino-worker',
        ScalableDimension='ecs:service:DesiredCount',
        PolicyType='TargetTrackingScaling',
        TargetTrackingScalingPolicyConfiguration={
            'TargetValue': 70.0,
            'PredefinedMetricSpecification': {
                'PredefinedMetricType': 'ECSServiceAverageCPUUtilization'
            },
            'ScaleOutCooldown': 300,
            'ScaleInCooldown': 300
        }
    )

    # 메모리 기반 스케일링 정책
    client.put_scaling_policy(
        PolicyName='trino-worker-memory-scaling',
        ServiceNamespace='ecs',
        ResourceId='service/trino-cluster/trino-worker',
        ScalableDimension='ecs:service:DesiredCount',
        PolicyType='TargetTrackingScaling',
        TargetTrackingScalingPolicyConfiguration={
            'TargetValue': 80.0,
            'PredefinedMetricSpecification': {
                'PredefinedMetricType': 'ECSServiceAverageMemoryUtilization'
            }
        }
    )
</code></pre>

<h3>3. Apache Iceberg 테이블 포맷 구현</h3>
<p><strong>Iceberg 카탈로그 설정:</strong></p>
<pre class="codehilite"><code class="language-properties"># catalog.properties
connector.name=iceberg
iceberg.catalog.type=glue
iceberg.glue.region=ap-northeast-2
iceberg.s3.region=ap-northeast-2
iceberg.table-statistics-enabled=true
iceberg.extended-statistics.enabled=true
</code></pre>

<p><strong>Iceberg 테이블 생성 및 관리:</strong></p>
<pre class="codehilite"><code class="language-sql">-- Iceberg 테이블 생성
CREATE TABLE iceberg.game_data.user_events (
    user_id BIGINT,
    event_time TIMESTAMP(6) WITH TIME ZONE,
    event_type VARCHAR,
    game_id VARCHAR,
    session_id VARCHAR,
    properties MAP(VARCHAR, VARCHAR),
    created_date DATE
)
WITH (
    format = 'PARQUET',
    partitioning = ARRAY['created_date'],
    location = 's3://data-lake-bucket/iceberg/user_events/',
    table_type = 'ICEBERG'
);

-- 파티션 기반 데이터 삽입
INSERT INTO iceberg.game_data.user_events
SELECT 
    user_id,
    event_time,
    event_type,
    game_id,
    session_id,
    properties,
    DATE(event_time) as created_date
FROM s3_source.raw_data.events
WHERE DATE(event_time) = DATE '2024-01-01';

-- 스키마 진화 예시
ALTER TABLE iceberg.game_data.user_events 
ADD COLUMN device_info MAP(VARCHAR, VARCHAR);

-- 타임 트래블 쿼리
SELECT * FROM iceberg.game_data.user_events 
FOR TIMESTAMP AS OF TIMESTAMP '2024-01-01 12:00:00';
</code></pre>

<h3>4. 다양한 데이터 소스 연동</h3>
<p><strong>커넥터 설정 및 최적화:</strong></p>
<pre class="codehilite"><code class="language-properties"># redshift.properties
connector.name=redshift
connection-url=jdbc:redshift://cluster.region.redshift.amazonaws.com:5439/dev
connection-user=${ENV:REDSHIFT_USER}
connection-password=${ENV:REDSHIFT_PASSWORD}
redshift.table-description-cache-ttl=1h
redshift.max-connections=50

# bigquery.properties  
connector.name=bigquery
bigquery.project-id=your-gcp-project
bigquery.parent-project-id=your-gcp-project
bigquery.credentials-file=/etc/trino/bigquery-credentials.json
bigquery.parallel-read-max-partitions=100

# mysql.properties
connector.name=mysql
connection-url=jdbc:mysql://mysql-server:3306
connection-user=${ENV:MYSQL_USER}
connection-password=${ENV:MYSQL_PASSWORD}
mysql.connection-timeout=10s
mysql.join-pushdown.enabled=true
</code></pre>

<p><strong>Cross-connector 쿼리 최적화:</strong></p>
<pre class="codehilite"><code class="language-sql">-- 다중 데이터 소스 조인 쿼리
WITH redshift_aggregates AS (
    SELECT 
        user_id,
        SUM(revenue) as total_revenue,
        COUNT(*) as transaction_count
    FROM redshift.analytics.user_transactions
    WHERE date_created &gt;= DATE '2024-01-01'
    GROUP BY user_id
),
bigquery_events AS (
    SELECT 
        user_id,
        COUNT(*) as event_count,
        MAX(event_time) as last_activity
    FROM bigquery.game_analytics.user_events
    WHERE DATE(event_time) &gt;= DATE '2024-01-01'
    GROUP BY user_id
)
SELECT 
    r.user_id,
    r.total_revenue,
    r.transaction_count,
    b.event_count,
    b.last_activity
FROM redshift_aggregates r
LEFT JOIN bigquery_events b ON r.user_id = b.user_id
WHERE r.total_revenue &gt; 100;
</code></pre>

<h3>5. S3 Lifecycle 정책 구현</h3>
<p><strong>자동 비용 최적화:</strong></p>
<pre class="codehilite"><code class="language-python">import boto3
import json

def setup_s3_lifecycle_policies():
    &quot;&quot;&quot;S3 데이터의 자동 비용 최적화 정책 설정&quot;&quot;&quot;

    s3_client = boto3.client('s3')

    lifecycle_config = {
        'Rules': [
            {
                'ID': 'IcebergDataLifecycle',
                'Status': 'Enabled',
                'Filter': {
                    'Prefix': 'iceberg/'
                },
                'Transitions': [
                    {
                        'Days': 30,
                        'StorageClass': 'STANDARD_IA'
                    },
                    {
                        'Days': 90,
                        'StorageClass': 'GLACIER'
                    },
                    {
                        'Days': 365,
                        'StorageClass': 'DEEP_ARCHIVE'
                    }
                ]
            },
            {
                'ID': 'IcebergMetadataLifecycle',
                'Status': 'Enabled',
                'Filter': {
                    'Prefix': 'iceberg/metadata/'
                },
                'Transitions': [
                    {
                        'Days': 90,
                        'StorageClass': 'STANDARD_IA'
                    }
                ]
            },
            {
                'ID': 'QueryResultsCleanup',
                'Status': 'Enabled',
                'Filter': {
                    'Prefix': 'query-results/'
                },
                'Expiration': {
                    'Days': 7
                }
            }
        ]
    }

    s3_client.put_bucket_lifecycle_configuration(
        Bucket='data-lake-bucket',
        LifecycleConfiguration=lifecycle_config
    )

def iceberg_table_maintenance():
    &quot;&quot;&quot;Iceberg 테이블 메인터넌스 작업&quot;&quot;&quot;
    import trino

    conn = trino.dbapi.connect(
        host='trino-coordinator.internal',
        port=8080,
        user='admin',
        catalog='iceberg',
        schema='game_data'
    )

    cursor = conn.cursor()

    # 오래된 스냅샷 정리
    cursor.execute(&quot;&quot;&quot;
        CALL iceberg.system.expire_snapshots(
            table =&gt; 'game_data.user_events',
            older_than =&gt; TIMESTAMP '2024-01-01 00:00:00',
            retain_last =&gt; 5
        )
    &quot;&quot;&quot;)

    # 작은 파일 통합
    cursor.execute(&quot;&quot;&quot;
        CALL iceberg.system.rewrite_data_files(
            table =&gt; 'game_data.user_events',
            strategy =&gt; 'sort',
            sort_order =&gt; 'event_time DESC'
        )
    &quot;&quot;&quot;)

    # 테이블 통계 업데이트
    cursor.execute(&quot;ANALYZE TABLE game_data.user_events&quot;)

    conn.close()
</code></pre>

<h3>6. 모니터링 및 성능 최적화</h3>
<p><strong>CloudWatch 메트릭 수집:</strong></p>
<pre class="codehilite"><code class="language-python">def collect_trino_metrics():
    &quot;&quot;&quot;Trino 클러스터의 성능 메트릭 수집&quot;&quot;&quot;

    import requests
    import boto3

    cloudwatch = boto3.client('cloudwatch')

    # Trino 코디네이터에서 메트릭 수집
    response = requests.get('http://trino-coordinator:8080/v1/node')
    nodes = response.json()

    active_workers = len([n for n in nodes if n['state'] == 'active'])

    # Trino 쿼리 통계 수집
    stats_response = requests.get('http://trino-coordinator:8080/v1/query')
    queries = stats_response.json()

    running_queries = len([q for q in queries if q['state'] == 'RUNNING'])

    # CloudWatch에 메트릭 전송
    cloudwatch.put_metric_data(
        Namespace='Trino/Cluster',
        MetricData=[
            {
                'MetricName': 'ActiveWorkers',
                'Value': active_workers,
                'Unit': 'Count'
            },
            {
                'MetricName': 'RunningQueries',
                'Value': running_queries,
                'Unit': 'Count'
            }
        ]
    )

def query_optimization_recommendations():
    &quot;&quot;&quot;쿼리 최적화 권장사항 분석&quot;&quot;&quot;

    # 느린 쿼리 탐지
    slow_queries = &quot;&quot;&quot;
        SELECT 
            query_id,
            query,
            state,
            elapsed_time_millis,
            total_bytes_processed,
            total_rows_processed
        FROM system.runtime.queries
        WHERE elapsed_time_millis &gt; 60000
        AND state = 'FINISHED'
        ORDER BY elapsed_time_millis DESC
        LIMIT 10
    &quot;&quot;&quot;

    # 리소스 사용량 분석
    resource_usage = &quot;&quot;&quot;
        SELECT 
            query_id,
            peak_user_memory_bytes / 1024 / 1024 / 1024 as peak_memory_gb,
            cumulative_memory_bytes / 1024 / 1024 / 1024 as cumulative_memory_gb,
            wall_time_millis / 1000 as wall_time_seconds
        FROM system.runtime.queries
        WHERE peak_user_memory_bytes &gt; 8589934592  -- 8GB 이상
        ORDER BY peak_user_memory_bytes DESC
    &quot;&quot;&quot;
</code></pre>

<h2>성과 및 임팩트</h2>
<h3>성능 지표</h3>
<ul>
<li><strong>쿼리 응답시간</strong>: Ad-hoc 쿼리 평균 30초 이내 처리</li>
<li><strong>동시 처리</strong>: 최대 50개 동시 쿼리 처리 가능</li>
<li><strong>데이터 처리량</strong>: 시간당 10TB 데이터 스캔 가능</li>
<li><strong>가용성</strong>: 99.9% 업타임 달성</li>
</ul>
<h3>비용 효율성</h3>
<ul>
<li><strong>인프라 비용</strong>: Spot Instance 활용으로 40% 비용 절감</li>
<li><strong>스토리지 비용</strong>: S3 Lifecycle으로 30% 스토리지 비용 절감</li>
<li><strong>운영 비용</strong>: 자동 스케일링으로 유휴 리소스 90% 감소</li>
</ul>
<h3>비즈니스 가치</h3>
<ul>
<li><strong>분석 민첩성</strong>: 데이터 분석가의 셀프 서비스 분석 환경 제공</li>
<li><strong>데이터 검증</strong>: ETL 파이프라인의 데이터 정합성 검증 시간 80% 단축</li>
<li><strong>통합 분석</strong>: 15개 이상 데이터 소스의 통합 분석 환경 구축</li>
<li><strong>개발 생산성</strong>: SQL 기반 통합 인터페이스로 개발 효율성 50% 향상</li>
</ul>
<h2>배운 점과 향후 개선 방향</h2>
<h3>주요 학습 내용</h3>
<ol>
<li><strong>Federated Query의 성능 최적화</strong></li>
<li>데이터 소스 간 조인 시 네트워크 비용 고려 필요</li>
<li>
<p>적절한 필터 푸시다운과 프로젝션 최적화의 중요성</p>
</li>
<li>
<p><strong>Iceberg 테이블 포맷의 장점</strong></p>
</li>
<li>ACID 트랜잭션과 스키마 진화의 강력함</li>
<li>
<p>타임 트래블 기능을 통한 데이터 버전 관리</p>
</li>
<li>
<p><strong>ECS 기반 컨테이너 오케스트레이션</strong></p>
</li>
<li>동적 스케일링과 고가용성의 균형점</li>
<li>Spot Instance 활용 시 상태 관리의 중요성</li>
</ol>
<h3>향후 개선 계획</h3>
<h4>단기 개선 사항 (3-6개월)</h4>
<ul>
<li><strong>쿼리 캐싱</strong>: Redis 기반 결과 캐싱으로 반복 쿼리 성능 향상</li>
<li><strong>보안 강화</strong>: Ranger 통합을 통한 세밀한 권한 관리</li>
<li><strong>메타데이터 관리</strong>: Apache Atlas를 통한 데이터 lineage 추적</li>
</ul>
<h4>중기 개선 사항 (6-12개월)</h4>
<ul>
<li><strong>실시간 스트리밍</strong>: Kafka 커넥터를 통한 실시간 데이터 조회</li>
<li><strong>ML 통합</strong>: SparkML과의 연동을 통한 ML 파이프라인 구축</li>
<li><strong>글로벌 확장</strong>: 다중 리전 배포를 통한 글로벌 데이터 레이크</li>
</ul>
<h4>장기 비전 (1-2년)</h4>
<ul>
<li><strong>완전 서버리스</strong>: Fargate 기반 완전 관리형 클러스터</li>
<li><strong>AI 기반 최적화</strong>: 자동 쿼리 최적화 및 인덱스 추천</li>
<li><strong>데이터 메시 통합</strong>: 도메인별 독립적인 데이터 제품 관리</li>
</ul>
<h3>기술 스택 진화 방향</h3>
<ul>
<li><strong>Delta Lake</strong>: Apache Iceberg 대안으로 Delta Lake 검토</li>
<li><strong>Kubernetes</strong>: ECS에서 EKS로의 마이그레이션 고려</li>
<li><strong>Starburst</strong>: 엔터프라이즈 Trino 솔루션 도입 검토</li>
</ul>
<p>이 프로젝트를 통해 현대적인 DataLake 아키텍처의 구축과 운영 노하우를 확보했으며, 조직의 셀프 서비스 분석 역량을 크게 향상시킬 수 있었습니다.</p>
                </div>
            </div>

            <!-- Back to Projects -->
            <div class="text-center mt-12">
                <a href="/#projects" class="inline-flex items-center px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-full hover:from-blue-700 hover:to-indigo-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1">
                    <i class="fas fa-arrow-left mr-3"></i>
                    프로젝트 목록으로 돌아가기
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p class="text-gray-300">&copy; 2024 SeungHo Choi. All rights reserved.</p>
        </div>
    </footer>

    <!-- Prism.js for code highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

</body>
</html>